# TBM Template アクティブコンテキスト

## 現在の作業内容

TBM（Technology Business Management）を小さく始めるためのテンプレートプロジェクトを作成しました。このプロジェクトは、TBMの基本的な構成要素を含み、Docker Composeを使って簡単に環境を構築できるようになっています。

現在、以下のコンポーネントが実装されています：

1. **データモデル**
   - TBMタクソノミーv4.0に基づいた階層構造（コストプール、ITタワー、テクノロジーサービス、ビジネスユニット、ビジネスケイパビリティ）
   - 各階層間の配賦ルールと計算ロジック
   - サンプルデータ（ABC商事の営業、経理、IT部門と、Salesforce、SAP、MS365、独自開発CRMの利用状況）

2. **データパイプライン（dbt）**
   - ステージングモデル：各マスターデータとトランザクションデータの整形
   - コアモデル：配賦計算ロジック
   - マートモデル：各視点（財務、IT、ビジネス）での集計データ

3. **データ収集（dlt）**
   - 各種外部サービス（Salesforce、SAP、MS365、独自開発CRM）からのデータ収集コネクタ
   - モックデータ生成機能

4. **可視化（Grafana）**
   - 財務視点ダッシュボード：コストプール別の支出状況
   - IT視点ダッシュボード：ITタワー、サービス別のコスト状況
   - ビジネス視点ダッシュボード：部門別、ケイパビリティ別のIT支出状況

5. **インフラ（Docker Compose）**
   - PostgreSQLデータベース
   - dbt、dlt、Grafanaの各コンテナ
   - 開発環境の設定

## 最近の変更

1. **プロジェクト全体の構築**
   - Docker Compose環境の構築
   - 各コンポーネントの設定と連携

2. **データモデルの実装**
   - TBMタクソノミーに基づいたデータモデルの設計
   - dbtモデルの実装（ステージング、コア、マート）
   - サンプルデータの作成

3. **データ収集コネクタの実装**
   - 各種外部サービス用のモックデータ生成モジュール
   - dltパイプラインの実装

4. **可視化ダッシュボードの作成**
   - Grafanaダッシュボードの設計と実装
   - 各視点（財務、IT、ビジネス）でのダッシュボード作成

5. **ドキュメントの整備**
   - README.mdの作成
   - メモリーバンクの作成

## 次のステップ

1. **テストの強化**
   - dbtモデルのテストケース追加
   - エンドツーエンドテストの実装

2. **実データ連携の強化**
   - 各外部サービスの実APIとの連携サンプルの追加
   - 認証情報管理の改善

3. **ダッシュボードの拡充**
   - より詳細な分析ビューの追加
   - ドリルダウン機能の強化

4. **パフォーマンス最適化**
   - 大規模データセットでのパフォーマンス検証
   - インデックス最適化

5. **デプロイメントガイドの作成**
   - 本番環境へのデプロイ手順
   - セキュリティ対策ガイド

## アクティブな決定事項と考慮点

1. **モックデータの使用**
   - 現在は、実際のAPIとの連携ではなく、モックデータを使用しています。
   - これは、テンプレートとしての汎用性を高めるためです。
   - 実際の環境では、APIキーなどの認証情報を適切に管理する必要があります。

2. **配賦ルールの簡素化**
   - 配賦ルールは、理解しやすさを優先して簡素化しています。
   - 実際の環境では、より複雑な配賦ルール（時間ベース、使用量ベースなど）が必要になる可能性があります。

3. **スケーラビリティの考慮**
   - 現在のアーキテクチャは、中小規模のデータ量を想定しています。
   - 大規模データの場合は、より高性能なデータベースやデータウェアハウスの導入を検討する必要があります。

4. **カスタマイズポイントの明確化**
   - テンプレートとして提供するため、カスタマイズポイントを明確にしています。
   - 特に、配賦ルールとデータ収集部分は、実際の環境に合わせたカスタマイズが必要です。

5. **オープンソースツールの採用**
   - コスト削減と拡張性を考慮して、オープンソースツールを積極的に採用しています。
   - 商用ツールが必要な場合は、プラグイン形式で追加できるようにしています。
