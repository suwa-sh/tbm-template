{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.2", "generated_at": "2025-04-28T04:17:57.211252Z", "invocation_id": "2064d588-35ef-421c-b84a-41fae6bd2b18", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.705804Z", "completed_at": "2025-04-28T04:17:56.710661Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.711205Z", "completed_at": "2025-04-28T04:17:56.753545Z"}], "thread_id": "Thread-1", "execution_time": 0.04900765419006348, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_business_capabilities", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"business_capabilities\"\n),\n\nrenamed as (\n    select\n        capability_id,\n        capability_name,\n        description,\n        capability_type\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_business_capabilities\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.756512Z", "completed_at": "2025-04-28T04:17:56.758437Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.758968Z", "completed_at": "2025-04-28T04:17:56.773403Z"}], "thread_id": "Thread-1", "execution_time": 0.018183231353759766, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_business_units", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"business_units\"\n),\n\nrenamed as (\n    select\n        business_unit_id,\n        business_unit_name,\n        description,\n        employee_count,\n        parent_id\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_business_units\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.776247Z", "completed_at": "2025-04-28T04:17:56.778015Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.778460Z", "completed_at": "2025-04-28T04:17:56.791990Z"}], "thread_id": "Thread-1", "execution_time": 0.017020463943481445, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_cost_entries", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"cost_entries\"\n),\n\nrenamed as (\n    select\n        cost_entry_id,\n        fiscal_year,\n        fiscal_month,\n        cost_pool_id,\n        cost_sub_pool_id,\n        vendor,\n        description,\n        amount\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_cost_entries\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.794829Z", "completed_at": "2025-04-28T04:17:56.796640Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.797164Z", "completed_at": "2025-04-28T04:17:56.811385Z"}], "thread_id": "Thread-1", "execution_time": 0.017792224884033203, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_cost_pools", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"cost_pools\"\n),\n\nrenamed as (\n    select\n        cost_pool_id,\n        cost_pool_name,\n        description\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_cost_pools\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.814187Z", "completed_at": "2025-04-28T04:17:56.816020Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.816464Z", "completed_at": "2025-04-28T04:17:56.830024Z"}], "thread_id": "Thread-1", "execution_time": 0.01713848114013672, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_cost_sub_pools", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"cost_sub_pools\"\n),\n\nrenamed as (\n    select\n        cost_sub_pool_id,\n        cost_pool_id,\n        cost_sub_pool_name,\n        description\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_cost_sub_pools\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.832925Z", "completed_at": "2025-04-28T04:17:56.834780Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.835236Z", "completed_at": "2025-04-28T04:17:56.849553Z"}], "thread_id": "Thread-1", "execution_time": 0.017899036407470703, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_cost_to_tower_allocations", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"cost_to_tower_allocations\"\n),\n\nrenamed as (\n    select\n        allocation_id,\n        cost_pool_id,\n        cost_sub_pool_id,\n        it_tower_id,\n        it_sub_tower_id,\n        allocation_method,\n        allocation_value,\n        description\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_cost_to_tower_allocations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.852412Z", "completed_at": "2025-04-28T04:17:56.854232Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.854710Z", "completed_at": "2025-04-28T04:17:56.868116Z"}], "thread_id": "Thread-1", "execution_time": 0.01692652702331543, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_it_sub_towers", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"it_sub_towers\"\n),\n\nrenamed as (\n    select\n        it_sub_tower_id,\n        it_tower_id,\n        it_sub_tower_name,\n        description\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_it_sub_towers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.870933Z", "completed_at": "2025-04-28T04:17:56.872816Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.873265Z", "completed_at": "2025-04-28T04:17:56.887471Z"}], "thread_id": "Thread-1", "execution_time": 0.017781734466552734, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_it_towers", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"it_towers\"\n),\n\nrenamed as (\n    select\n        it_tower_id,\n        it_tower_name,\n        description\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_it_towers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.890323Z", "completed_at": "2025-04-28T04:17:56.892221Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.892678Z", "completed_at": "2025-04-28T04:17:56.906328Z"}], "thread_id": "Thread-1", "execution_time": 0.01724839210510254, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_service_to_business_allocations", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"service_to_business_allocations\"\n),\n\nrenamed as (\n    select\n        allocation_id,\n        service_id,\n        business_unit_id,\n        allocation_method,\n        allocation_value,\n        description\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_service_to_business_allocations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.909204Z", "completed_at": "2025-04-28T04:17:56.910994Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.911432Z", "completed_at": "2025-04-28T04:17:56.926405Z"}], "thread_id": "Thread-1", "execution_time": 0.018508434295654297, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_service_to_capability_allocations", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"service_to_capability_allocations\"\n),\n\nrenamed as (\n    select\n        allocation_id,\n        service_id,\n        capability_id,\n        allocation_method,\n        allocation_value,\n        description\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_service_to_capability_allocations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.930545Z", "completed_at": "2025-04-28T04:17:56.932676Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.933237Z", "completed_at": "2025-04-28T04:17:56.950987Z"}], "thread_id": "Thread-1", "execution_time": 0.021970510482788086, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_tech_services", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"tech_services\"\n),\n\nrenamed as (\n    select\n        service_id,\n        service_name,\n        description,\n        service_type\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_tech_services\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.954641Z", "completed_at": "2025-04-28T04:17:56.958031Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.958601Z", "completed_at": "2025-04-28T04:17:56.976585Z"}], "thread_id": "Thread-1", "execution_time": 0.023396730422973633, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.tbm_template.stg_tower_to_service_allocations", "compiled": true, "compiled_code": "with source as (\n    select * from \"tbm_db\".\"public_raw\".\"tower_to_service_allocations\"\n),\n\nrenamed as (\n    select\n        allocation_id,\n        it_tower_id,\n        it_sub_tower_id,\n        service_id,\n        allocation_method,\n        allocation_value,\n        description\n    from source\n)\n\nselect * from renamed", "relation_name": "\"tbm_db\".\"public\".\"stg_tower_to_service_allocations\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:56.979840Z", "completed_at": "2025-04-28T04:17:56.982432Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:56.982918Z", "completed_at": "2025-04-28T04:17:57.013510Z"}], "thread_id": "Thread-1", "execution_time": 0.035033464431762695, "adapter_response": {"_message": "SELECT 15", "code": "SELECT", "rows_affected": 15}, "message": "SELECT 15", "failures": null, "unique_id": "model.tbm_template.cost_pool_summary", "compiled": true, "compiled_code": "with cost_entries as (\n    select * from \"tbm_db\".\"public\".\"stg_cost_entries\"\n),\n\ncost_pools as (\n    select * from \"tbm_db\".\"public\".\"stg_cost_pools\"\n),\n\ncost_sub_pools as (\n    select * from \"tbm_db\".\"public\".\"stg_cost_sub_pools\"\n),\n\n-- \u30b3\u30b9\u30c8\u30d7\u30fc\u30eb\u5225\u306e\u96c6\u8a08\ncost_pool_summary as (\n    select\n        ce.fiscal_year,\n        ce.fiscal_month,\n        ce.cost_pool_id,\n        cp.cost_pool_name,\n        ce.cost_sub_pool_id,\n        csp.cost_sub_pool_name,\n        sum(ce.amount) as total_amount,\n        count(distinct ce.cost_entry_id) as entry_count\n    from cost_entries ce\n    left join cost_pools cp on ce.cost_pool_id = cp.cost_pool_id\n    left join cost_sub_pools csp on ce.cost_sub_pool_id = csp.cost_sub_pool_id\n    group by 1, 2, 3, 4, 5, 6\n)\n\nselect * from cost_pool_summary", "relation_name": "\"tbm_db\".\"public_finance\".\"cost_pool_summary\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:57.016490Z", "completed_at": "2025-04-28T04:17:57.019361Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:57.019850Z", "completed_at": "2025-04-28T04:17:57.037765Z"}], "thread_id": "Thread-1", "execution_time": 0.02250814437866211, "adapter_response": {"_message": "SELECT 45", "code": "SELECT", "rows_affected": 45}, "message": "SELECT 45", "failures": null, "unique_id": "model.tbm_template.cost_to_tower", "compiled": true, "compiled_code": "with cost_entries as (\n    select * from \"tbm_db\".\"public\".\"stg_cost_entries\"\n),\n\ncost_pools as (\n    select * from \"tbm_db\".\"public\".\"stg_cost_pools\"\n),\n\ncost_sub_pools as (\n    select * from \"tbm_db\".\"public\".\"stg_cost_sub_pools\"\n),\n\nit_towers as (\n    select * from \"tbm_db\".\"public\".\"stg_it_towers\"\n),\n\nit_sub_towers as (\n    select * from \"tbm_db\".\"public\".\"stg_it_sub_towers\"\n),\n\nallocations as (\n    select * from \"tbm_db\".\"public\".\"stg_cost_to_tower_allocations\"\n),\n\n-- \u30b3\u30b9\u30c8\u9805\u76ee\u3068\u30b3\u30b9\u30c8\u30d7\u30fc\u30eb\u30fb\u30b5\u30d6\u30d7\u30fc\u30eb\u306e\u7d50\u5408\ncost_entries_with_pools as (\n    select\n        ce.cost_entry_id,\n        ce.fiscal_year,\n        ce.fiscal_month,\n        ce.cost_pool_id,\n        cp.cost_pool_name,\n        ce.cost_sub_pool_id,\n        csp.cost_sub_pool_name,\n        ce.vendor,\n        ce.description,\n        ce.amount\n    from cost_entries ce\n    left join cost_pools cp on ce.cost_pool_id = cp.cost_pool_id\n    left join cost_sub_pools csp on ce.cost_sub_pool_id = csp.cost_sub_pool_id\n),\n\n-- \u30b3\u30b9\u30c8\u9805\u76ee\u3068IT\u30bf\u30ef\u30fc\u3078\u306e\u914d\u8ce6\ncost_to_tower_allocation as (\n    select\n        ce.cost_entry_id,\n        ce.fiscal_year,\n        ce.fiscal_month,\n        ce.cost_pool_id,\n        ce.cost_pool_name,\n        ce.cost_sub_pool_id,\n        ce.cost_sub_pool_name,\n        a.it_tower_id,\n        it.it_tower_name,\n        a.it_sub_tower_id,\n        ist.it_sub_tower_name,\n        a.allocation_method,\n        a.allocation_value,\n        ce.amount * a.allocation_value as allocated_amount,\n        ce.vendor,\n        ce.description,\n        a.description as allocation_description\n    from cost_entries_with_pools ce\n    inner join allocations a \n        on ce.cost_pool_id = a.cost_pool_id \n        and ce.cost_sub_pool_id = a.cost_sub_pool_id\n    left join it_towers it on a.it_tower_id = it.it_tower_id\n    left join it_sub_towers ist on a.it_sub_tower_id = ist.it_sub_tower_id\n)\n\nselect * from cost_to_tower_allocation", "relation_name": "\"tbm_db\".\"public\".\"cost_to_tower\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:57.041081Z", "completed_at": "2025-04-28T04:17:57.043249Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:57.043715Z", "completed_at": "2025-04-28T04:17:57.060661Z"}], "thread_id": "Thread-1", "execution_time": 0.020910263061523438, "adapter_response": {"_message": "SELECT 14", "code": "SELECT", "rows_affected": 14}, "message": "SELECT 14", "failures": null, "unique_id": "model.tbm_template.tower_cost_summary", "compiled": true, "compiled_code": "with tower_costs as (\n    select * from \"tbm_db\".\"public\".\"cost_to_tower\"\n),\n\n-- IT\u30bf\u30ef\u30fc\u5225\u306e\u96c6\u8a08\ntower_cost_summary as (\n    select\n        fiscal_year,\n        fiscal_month,\n        it_tower_id,\n        it_tower_name,\n        it_sub_tower_id,\n        it_sub_tower_name,\n        sum(allocated_amount) as total_allocated_amount,\n        count(distinct cost_entry_id) as entry_count\n    from tower_costs\n    group by 1, 2, 3, 4, 5, 6\n)\n\nselect * from tower_cost_summary", "relation_name": "\"tbm_db\".\"public_it\".\"tower_cost_summary\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:57.063780Z", "completed_at": "2025-04-28T04:17:57.066143Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:57.066686Z", "completed_at": "2025-04-28T04:17:57.084269Z"}], "thread_id": "Thread-1", "execution_time": 0.021860361099243164, "adapter_response": {"_message": "SELECT 154", "code": "SELECT", "rows_affected": 154}, "message": "SELECT 154", "failures": null, "unique_id": "model.tbm_template.tower_to_service", "compiled": true, "compiled_code": "with tower_costs as (\n    select * from \"tbm_db\".\"public\".\"cost_to_tower\"\n),\n\ntech_services as (\n    select * from \"tbm_db\".\"public\".\"stg_tech_services\"\n),\n\nallocations as (\n    select * from \"tbm_db\".\"public\".\"stg_tower_to_service_allocations\"\n),\n\n-- IT\u30bf\u30ef\u30fc\u30b3\u30b9\u30c8\u3068\u30c6\u30af\u30ce\u30ed\u30b8\u30fc\u30b5\u30fc\u30d3\u30b9\u3078\u306e\u914d\u8ce6\ntower_to_service_allocation as (\n    select\n        tc.cost_entry_id,\n        tc.fiscal_year,\n        tc.fiscal_month,\n        tc.cost_pool_id,\n        tc.cost_pool_name,\n        tc.cost_sub_pool_id,\n        tc.cost_sub_pool_name,\n        tc.it_tower_id,\n        tc.it_tower_name,\n        tc.it_sub_tower_id,\n        tc.it_sub_tower_name,\n        a.service_id,\n        ts.service_name,\n        ts.service_type,\n        a.allocation_method,\n        a.allocation_value,\n        tc.allocated_amount * a.allocation_value as allocated_amount,\n        tc.vendor,\n        tc.description as cost_description,\n        tc.allocation_description as tower_allocation_description,\n        a.description as service_allocation_description\n    from tower_costs tc\n    inner join allocations a \n        on tc.it_tower_id = a.it_tower_id \n        and tc.it_sub_tower_id = a.it_sub_tower_id\n    left join tech_services ts on a.service_id = ts.service_id\n)\n\nselect * from tower_to_service_allocation", "relation_name": "\"tbm_db\".\"public\".\"tower_to_service\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:57.087420Z", "completed_at": "2025-04-28T04:17:57.089413Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:57.089947Z", "completed_at": "2025-04-28T04:17:57.106780Z"}], "thread_id": "Thread-1", "execution_time": 0.0207216739654541, "adapter_response": {"_message": "SELECT 9", "code": "SELECT", "rows_affected": 9}, "message": "SELECT 9", "failures": null, "unique_id": "model.tbm_template.service_cost_summary", "compiled": true, "compiled_code": "with service_costs as (\n    select * from \"tbm_db\".\"public\".\"tower_to_service\"\n),\n\n-- \u30c6\u30af\u30ce\u30ed\u30b8\u30fc\u30b5\u30fc\u30d3\u30b9\u5225\u306e\u96c6\u8a08\nservice_cost_summary as (\n    select\n        fiscal_year,\n        fiscal_month,\n        service_id,\n        service_name,\n        service_type,\n        sum(allocated_amount) as total_allocated_amount,\n        count(distinct cost_entry_id) as entry_count\n    from service_costs\n    group by 1, 2, 3, 4, 5\n)\n\nselect * from service_cost_summary", "relation_name": "\"tbm_db\".\"public_it\".\"service_cost_summary\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:57.109666Z", "completed_at": "2025-04-28T04:17:57.112025Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:57.112522Z", "completed_at": "2025-04-28T04:17:57.129041Z"}], "thread_id": "Thread-1", "execution_time": 0.02066802978515625, "adapter_response": {"_message": "SELECT 355", "code": "SELECT", "rows_affected": 355}, "message": "SELECT 355", "failures": null, "unique_id": "model.tbm_template.service_to_business", "compiled": true, "compiled_code": "with service_costs as (\n    select * from \"tbm_db\".\"public\".\"tower_to_service\"\n),\n\nbusiness_units as (\n    select * from \"tbm_db\".\"public\".\"stg_business_units\"\n),\n\nallocations as (\n    select * from \"tbm_db\".\"public\".\"stg_service_to_business_allocations\"\n),\n\n-- \u30c6\u30af\u30ce\u30ed\u30b8\u30fc\u30b5\u30fc\u30d3\u30b9\u30b3\u30b9\u30c8\u3068\u30d3\u30b8\u30cd\u30b9\u30e6\u30cb\u30c3\u30c8\u3078\u306e\u914d\u8ce6\nservice_to_business_allocation as (\n    select\n        sc.cost_entry_id,\n        sc.fiscal_year,\n        sc.fiscal_month,\n        sc.cost_pool_id,\n        sc.cost_pool_name,\n        sc.cost_sub_pool_id,\n        sc.cost_sub_pool_name,\n        sc.it_tower_id,\n        sc.it_tower_name,\n        sc.it_sub_tower_id,\n        sc.it_sub_tower_name,\n        sc.service_id,\n        sc.service_name,\n        sc.service_type,\n        a.business_unit_id,\n        bu.business_unit_name,\n        bu.employee_count,\n        bu.parent_id,\n        a.allocation_method,\n        a.allocation_value,\n        sc.allocated_amount * a.allocation_value as allocated_amount,\n        sc.vendor,\n        sc.cost_description,\n        sc.tower_allocation_description,\n        sc.service_allocation_description,\n        a.description as business_allocation_description\n    from service_costs sc\n    inner join allocations a on sc.service_id = a.service_id\n    left join business_units bu on a.business_unit_id = bu.business_unit_id\n)\n\nselect * from service_to_business_allocation", "relation_name": "\"tbm_db\".\"public\".\"service_to_business\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:57.132257Z", "completed_at": "2025-04-28T04:17:57.134651Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:57.135150Z", "completed_at": "2025-04-28T04:17:57.153842Z"}], "thread_id": "Thread-1", "execution_time": 0.022979021072387695, "adapter_response": {"_message": "SELECT 642", "code": "SELECT", "rows_affected": 642}, "message": "SELECT 642", "failures": null, "unique_id": "model.tbm_template.service_to_capability", "compiled": true, "compiled_code": "with service_costs as (\n    select * from \"tbm_db\".\"public\".\"tower_to_service\"\n),\n\nbusiness_capabilities as (\n    select * from \"tbm_db\".\"public\".\"stg_business_capabilities\"\n),\n\nallocations as (\n    select * from \"tbm_db\".\"public\".\"stg_service_to_capability_allocations\"\n),\n\n-- \u30c6\u30af\u30ce\u30ed\u30b8\u30fc\u30b5\u30fc\u30d3\u30b9\u30b3\u30b9\u30c8\u3068\u30d3\u30b8\u30cd\u30b9\u30b1\u30a4\u30d1\u30d3\u30ea\u30c6\u30a3\u3078\u306e\u914d\u8ce6\nservice_to_capability_allocation as (\n    select\n        sc.cost_entry_id,\n        sc.fiscal_year,\n        sc.fiscal_month,\n        sc.cost_pool_id,\n        sc.cost_pool_name,\n        sc.cost_sub_pool_id,\n        sc.cost_sub_pool_name,\n        sc.it_tower_id,\n        sc.it_tower_name,\n        sc.it_sub_tower_id,\n        sc.it_sub_tower_name,\n        sc.service_id,\n        sc.service_name,\n        sc.service_type,\n        a.capability_id,\n        bc.capability_name,\n        bc.capability_type,\n        a.allocation_method,\n        a.allocation_value,\n        sc.allocated_amount * a.allocation_value as allocated_amount,\n        sc.vendor,\n        sc.cost_description,\n        sc.tower_allocation_description,\n        sc.service_allocation_description,\n        a.description as capability_allocation_description\n    from service_costs sc\n    inner join allocations a on sc.service_id = a.service_id\n    left join business_capabilities bc on a.capability_id = bc.capability_id\n)\n\nselect * from service_to_capability_allocation", "relation_name": "\"tbm_db\".\"public\".\"service_to_capability\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:57.156839Z", "completed_at": "2025-04-28T04:17:57.158959Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:57.159418Z", "completed_at": "2025-04-28T04:17:57.176767Z"}], "thread_id": "Thread-1", "execution_time": 0.02126455307006836, "adapter_response": {"_message": "SELECT 3", "code": "SELECT", "rows_affected": 3}, "message": "SELECT 3", "failures": null, "unique_id": "model.tbm_template.business_unit_cost_summary", "compiled": true, "compiled_code": "with business_costs as (\n    select * from \"tbm_db\".\"public\".\"service_to_business\"\n),\n\n-- \u30d3\u30b8\u30cd\u30b9\u30e6\u30cb\u30c3\u30c8\u5225\u306e\u96c6\u8a08\nbusiness_unit_cost_summary as (\n    select\n        fiscal_year,\n        fiscal_month,\n        business_unit_id,\n        business_unit_name,\n        parent_id,\n        employee_count,\n        sum(allocated_amount) as total_allocated_amount,\n        count(distinct service_id) as service_count\n    from business_costs\n    group by 1, 2, 3, 4, 5, 6\n)\n\nselect * from business_unit_cost_summary", "relation_name": "\"tbm_db\".\"public_business\".\"business_unit_cost_summary\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-28T04:17:57.181171Z", "completed_at": "2025-04-28T04:17:57.184476Z"}, {"name": "execute", "started_at": "2025-04-28T04:17:57.185204Z", "completed_at": "2025-04-28T04:17:57.203127Z"}], "thread_id": "Thread-1", "execution_time": 0.0236508846282959, "adapter_response": {"_message": "SELECT 10", "code": "SELECT", "rows_affected": 10}, "message": "SELECT 10", "failures": null, "unique_id": "model.tbm_template.capability_cost_summary", "compiled": true, "compiled_code": "with capability_costs as (\n    select * from \"tbm_db\".\"public\".\"service_to_capability\"\n),\n\n-- \u30d3\u30b8\u30cd\u30b9\u30b1\u30a4\u30d1\u30d3\u30ea\u30c6\u30a3\u5225\u306e\u96c6\u8a08\ncapability_cost_summary as (\n    select\n        fiscal_year,\n        fiscal_month,\n        capability_id,\n        capability_name,\n        capability_type,\n        sum(allocated_amount) as total_allocated_amount,\n        count(distinct service_id) as service_count\n    from capability_costs\n    group by 1, 2, 3, 4, 5\n)\n\nselect * from capability_cost_summary", "relation_name": "\"tbm_db\".\"public_business\".\"capability_cost_summary\""}], "elapsed_time": 0.6520016193389893, "args": {"use_colors_file": true, "macro_debugging": false, "partial_parse": true, "favor_state": false, "cache_selected_only": false, "vars": {}, "log_level": "info", "profiles_dir": "/app/dbt/files", "which": "run", "print": true, "introspect": true, "static_parser": true, "partial_parse_file_diff": true, "project_dir": "/app/dbt/src", "enable_legacy_logger": false, "defer": false, "log_path": "/app/dbt/src/logs", "log_format": "default", "send_anonymous_usage_stats": true, "select": [], "quiet": false, "log_file_max_bytes": 10485760, "exclude": [], "version_check": true, "use_colors": true, "show_resource_report": false, "log_level_file": "debug", "printer_width": 80, "strict_mode": false, "indirect_selection": "eager", "populate_cache": true, "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "write_json": true, "invocation_command": "dbt run"}}